---
title: "2026年2月4日（水）"
date: 2026-02-04
slug: "2026-02-04"
draft: false
---
検討すべき本をOCRして、丸ごとWorkflowyに流し込んで、線を引きながら読み、重要な部分を抜粋した。一度すべてをテキストデータにした上で分析を進めることには、抜け漏れなくデータを扱えているという安心感がある。文章を自由に読むには手続き的な不安がないほうがいい。

なお、日本語の縦書き二段組の本を処理するために用いたのは以下。使い方はAIに聞けばわかると思います。
```Python
import os
import time
from google import genai
from pdf2image import convert_from_path

# ================= 設定エリア =================
PDF_PATH = 'ファイルの場所'
API_KEY = '自分のGeminiのAPI'
DPI = 300
# スクリーンショットにある最新の Flash モデルを指定
MODEL_ID = "gemini-2.5-flash" 
# 分割して送る場合、1ページあたり合計2リクエスト。300ページなら余裕です。
WAIT_TIME = 2 
# ============================================

def run_ultimate_ocr():
    client = genai.Client(api_key=API_KEY)
    output_path = PDF_PATH.replace('.pdf', '_gemini_2.5_result.txt')
    
    images = convert_from_path(PDF_PATH, dpi=DPI)
    total_pages = len(images)

    with open(output_path, 'a', encoding='utf-8') as f:
        for i, image in enumerate(images):
            page_num = i + 1
            width, height = image.size
            margin = int(width * 0.05)
            center = width // 2
            
            # 左右分割（重なりあり）
            parts = [
                image.crop((center - margin, 0, width, height)), # 右段
                image.crop((0, 0, center + margin, height))      # 左段
            ]
            
            print(f"[{page_num}/{total_pages}] {MODEL_ID} で解析中...")
            page_content = f"\n--- Page {page_num} ---\n"

            for idx, part in enumerate(parts):
                side = "右側" if idx == 0 else "左側"
                
                # 改行と段落を制御する強力なプロンプト
                prompt = f"""
                あなたはプロの校正者です。提示された画像（縦書き文書の{side}）をテキスト化してください。

                【最優先ルール】
                1. 文章を繋げる: 1行の終わりで発生している物理的な改行はすべて削除し、一つの意味の通る文章として繋げてください。
                2. 段落の維持: 文頭が一文字下がっている箇所や、明らかに話題が変わる箇所のみ、改行（段落分け）を行ってください。
                3. ゴミの排除: ページ端のノイズや、半分切れている隣の段の文字は完全に無視してください。
                4. 本文のみ: 解説や挨拶は一切不要です。
                """
                
                try:
                    response = client.models.generate_content(model=MODEL_ID, contents=[prompt, part])
                    page_content += response.text + "\n"
                    time.sleep(WAIT_TIME)
                except Exception as e:
                    print(f"エラー: {e}")

            f.write(page_content)
            f.flush()

    print(f"完了しました！モデル: {MODEL_ID}")

if __name__ == '__main__':
    run_ultimate_ocr()
```
